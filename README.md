# 엑셀 파일 자동 편집 프로그램

반복적인 엑셀 데이터 입력을 편리하게 해주는 Electron 기반 데스크톱 애플리케이션입니다.

## 🎯 주요 기능

### 📁 **파일 관리**
- **외부 폴더 접근**: 컴퓨터의 어느 폴더든 선택하여 엑셀 파일을 찾을 수 있습니다
- **엑셀 파일 자동 감지**: `.xlsx`, `.xls` 파일을 자동으로 탐지
- **파일별 템플릿**: 각 엑셀 파일마다 개별적인 설정을 저장하고 불러올 수 있습니다

### 📝 **입력값 관리**
- **동적 입력값 관리**: 사용자가 원하는 만큼 입력값을 추가/삭제/편집할 수 있습니다
- **입력값 필터링**: 빈 입력값은 자동으로 제외하여 깔끔한 작업 환경 제공
- **실시간 검증**: 입력값과 셀 규칙 간의 연결 상태 실시간 확인

### ⚙️ **셀 변경 규칙**
- **전체/부분 교체**: 셀 전체를 교체하거나 기존 내용의 일부만 교체할 수 있습니다
- **셀 주소 검증**: A1, B2 형식의 셀 주소 자동 검증 및 대문자 변환
- **시트별 관리**: 여러 시트에 걸친 복잡한 규칙 설정 가능
- **규칙 유효성 검사**: 잘못된 셀 주소 입력 시 자동으로 연결된 입력값 초기화

### 🔍 **미리보기 및 적용**
- **미리보기 기능**: 변경사항을 적용하기 전에 미리 확인할 수 있습니다
- **변경사항 요약**: 총 규칙 수와 유효한 규칙 수를 실시간으로 표시
- **안전한 적용**: 원본 파일을 보존하고 수정된 파일을 output 폴더에 생성
- **자동 파일명**: `원본파일명_수정됨_날짜시간.xlsx` 형식으로 자동 저장

### 💾 **설정 관리**
- **개인별 설정 저장**: 선택한 폴더와 셀 변경 규칙이 자동으로 저장됩니다
- **템플릿 시스템**: 파일별로 완전히 독립적인 템플릿 관리
- **설정 모달**: JSON 형태로 모든 템플릿 설정을 확인할 수 있습니다

## 🚀 설치 및 실행

### 필수 요구사항
- Node.js (v16 이상)
- npm

### 설치
```bash
npm install
```

### 개발 모드 실행
```bash
# Electron 앱으로 실행 (권장)
npm run electron-dev

# 웹 브라우저에서 실행
npm run dev
```

### 빌드
```bash
# 개발용 빌드 (실행 파일만)
npm run electron-build

# 배포용 빌드 (설치 파일 포함)
npm run dist
```

## 📖 사용법

### 1단계: 폴더 및 파일 선택
1. **폴더 선택**: "폴더 선택" 버튼을 클릭하여 엑셀 파일이 있는 폴더를 선택
2. **파일 선택**: 목록에서 편집할 엑셀 파일을 선택 (자동으로 템플릿 로드)

### 2단계: 입력값 설정
1. **입력값 추가**: "입력값 추가" 버튼을 클릭하여 필요한 데이터들을 추가
2. **입력값 편집**: 각 입력값을 원하는 내용으로 수정
3. **입력값 삭제**: 불필요한 입력값은 삭제 버튼으로 제거

### 3단계: 셀 변경 규칙 설정
1. **규칙 추가**: "규칙 추가" 버튼을 클릭하여 셀 변경 규칙을 생성
2. **규칙 설정**:
   - **규칙명**: 규칙을 구분하기 위한 이름
   - **시트명**: 편집할 시트 선택
   - **셀 주소**: 편집할 셀 주소 (예: A1, B2, AA10)
   - **사용 입력값**: 적용할 입력값 선택
   - **교체 방식**: 
     - `전체 교체`: 셀 내용을 완전히 교체
     - `부분 교체`: 특정 패턴을 찾아 교체 (패턴 입력 필요)

### 4단계: 작업 실행
1. **미리보기**: "미리보기" 버튼을 클릭하여 변경사항을 확인
2. **적용 및 저장**: "변경사항 적용 및 output 폴더에 저장" 버튼을 클릭하여 파일 저장

## 🏗️ 기술 스택

### Frontend
- **React 19**: 사용자 인터페이스
- **TypeScript**: 타입 안전성
- **React Bootstrap**: UI 컴포넌트
- **React Toastify**: 토스트 알림 시스템

### Backend
- **Electron**: 데스크톱 애플리케이션 프레임워크
- **SheetJS (xlsx)**: 엑셀 파일 처리
- **electron-store**: 설정 저장
- **fs-extra**: 파일 시스템 확장 기능

### Build Tools
- **Vite**: 빌드 도구
- **Electron Builder**: 배포 패키징

## 📁 프로젝트 구조

```
src/
├── components/           # React 컴포넌트
│   ├── FolderSelector.tsx      # 폴더 선택 컴포넌트
│   ├── InputValueManager.tsx   # 입력값 관리 컴포넌트
│   ├── CellRuleManager.tsx     # 셀 규칙 관리 컴포넌트
│   ├── WorkflowExecutor.tsx    # 작업 실행 컴포넌트
│   ├── ChangePreview.tsx       # 변경사항 미리보기
│   ├── ModalProvider.tsx       # 모달 상태 관리
│   └── HelpMessage.tsx         # 도움말 메시지
├── hooks/               # Custom Hooks
│   ├── useFileSystem.ts # 파일 시스템 관련 로직
│   ├── useTemplate.ts   # 템플릿 관리 로직
│   └── useWorkflow.ts   # 작업 실행 로직
├── App.tsx              # 메인 애플리케이션 컴포넌트
├── type.ts              # TypeScript 타입 정의
├── util.ts              # 유틸리티 함수
└── main.tsx             # React 앱 진입점

main.js                  # Electron 메인 프로세스
preload.js               # Electron 프리로드 스크립트
```

## 🎨 주요 사용 사례

### 1. 반복적인 데이터 입력
동일한 형식의 엑셀 파일에 반복적으로 데이터를 입력해야 하는 경우

### 2. 템플릿 기반 작업
미리 설정한 규칙으로 여러 파일을 일괄 처리하는 경우

### 3. 데이터 교체
기존 엑셀 파일의 특정 셀들을 새로운 데이터로 교체하는 경우

### 4. 배치 처리
여러 엑셀 파일을 동일한 규칙으로 일괄 처리하는 경우

## 🔧 빌드 문제 해결

### 포트 충돌 문제
개발 모드에서 포트 충돌이 발생하는 경우:
```bash
# 기존 프로세스 종료
taskkill /f /im node.exe

# 다시 실행
npm run electron-dev
```

### 빌드 오류
빌드 중 "파일이 사용 중" 오류가 발생하면:
1. 실행 중인 앱 종료
2. `dist-electron` 폴더 삭제
3. `npm run electron-build` 재실행

## 📦 배포

### Windows
```bash
npm run dist
```
- `dist-electron/win-unpacked/` 폴더의 실행 파일 배포
- 또는 `dist-electron/` 폴더의 설치 파일 배포

### 실행 파일 공유
- `win-unpacked` 폴더 전체를 압축하여 공유
- 별도 설치 없이 실행 가능

## 📄 라이선스

MIT License

## 👨‍💻 개발자

Sangmo Koo <green0614@gmail.com>